  0%|          | 0/169001437 [00:00<?, ?it/s]  1%|          | 851968/169001437 [00:00<00:19, 8433489.31it/s]  3%|▎         | 5210112/169001437 [00:00<00:05, 29014145.85it/s]  6%|▌         | 9371648/169001437 [00:00<00:04, 34595714.38it/s]  8%|▊         | 13074432/169001437 [00:00<00:04, 35412667.52it/s] 10%|█         | 17268736/169001437 [00:00<00:04, 37617886.13it/s] 13%|█▎        | 21200896/169001437 [00:00<00:03, 38025598.90it/s] 15%|█▍        | 25034752/169001437 [00:00<00:03, 37764621.89it/s] 17%|█▋        | 29327360/169001437 [00:00<00:03, 39312911.16it/s] 20%|█▉        | 33292288/169001437 [00:00<00:03, 36106476.51it/s] 22%|██▏       | 36962304/169001437 [00:01<00:04, 32312506.49it/s] 24%|██▍       | 40304640/169001437 [00:01<00:04, 29517412.17it/s] 26%|██▌       | 43352064/169001437 [00:01<00:04, 28150111.76it/s] 27%|██▋       | 46235648/169001437 [00:01<00:04, 27226536.07it/s] 29%|██▉       | 49020928/169001437 [00:01<00:04, 24441227.35it/s] 30%|███       | 51544064/169001437 [00:01<00:06, 17440996.96it/s] 32%|███▏      | 53608448/169001437 [00:02<00:09, 11846480.29it/s] 33%|███▎      | 55214080/169001437 [00:02<00:12, 9269637.38it/s]  33%|███▎      | 56492032/169001437 [00:02<00:13, 8241619.19it/s] 34%|███▍      | 57573376/169001437 [00:02<00:14, 7646396.27it/s] 35%|███▍      | 58490880/169001437 [00:03<00:15, 7020836.34it/s] 35%|███▌      | 59310080/169001437 [00:03<00:16, 6549840.38it/s] 36%|███▌      | 60030976/169001437 [00:03<00:17, 6259890.68it/s] 36%|███▌      | 60686336/169001437 [00:03<00:17, 6136328.08it/s] 36%|███▋      | 61341696/169001437 [00:03<00:17, 6084750.11it/s] 37%|███▋      | 61964288/169001437 [00:03<00:17, 6111404.16it/s] 37%|███▋      | 62586880/169001437 [00:03<00:17, 6113046.82it/s] 37%|███▋      | 63275008/169001437 [00:03<00:16, 6221675.69it/s] 38%|███▊      | 63995904/169001437 [00:04<00:16, 6416222.41it/s] 38%|███▊      | 64716800/169001437 [00:04<00:15, 6590804.10it/s] 39%|███▊      | 65437696/169001437 [00:04<00:15, 6694475.35it/s] 39%|███▉      | 66224128/169001437 [00:04<00:14, 6951184.92it/s] 40%|███▉      | 67043328/169001437 [00:04<00:14, 7279054.78it/s] 40%|████      | 67796992/169001437 [00:04<00:13, 7323342.44it/s] 41%|████      | 68648960/169001437 [00:04<00:13, 7603522.83it/s] 41%|████      | 69468160/169001437 [00:04<00:12, 7772767.77it/s] 42%|████▏     | 70352896/169001437 [00:04<00:12, 8026555.94it/s] 42%|████▏     | 71270400/169001437 [00:05<00:11, 8317788.04it/s] 43%|████▎     | 72187904/169001437 [00:05<00:11, 8457158.64it/s] 43%|████▎     | 73138176/169001437 [00:05<00:11, 8712957.94it/s] 44%|████▍     | 74088448/169001437 [00:05<00:10, 8881503.12it/s] 44%|████▍     | 75071488/169001437 [00:05<00:10, 9156213.12it/s] 45%|████▍     | 75988992/169001437 [00:05<00:10, 9008627.73it/s] 46%|████▌     | 76906496/169001437 [00:05<00:10, 8376297.43it/s] 46%|████▌     | 77758464/169001437 [00:05<00:11, 8081906.32it/s] 46%|████▋     | 78577664/169001437 [00:05<00:11, 7958661.07it/s] 47%|████▋     | 79396864/169001437 [00:05<00:11, 7887068.75it/s] 47%|████▋     | 80216064/169001437 [00:06<00:11, 7932389.03it/s] 48%|████▊     | 81035264/169001437 [00:06<00:11, 7481598.33it/s] 48%|████▊     | 81821696/169001437 [00:06<00:12, 6999644.75it/s] 49%|████▉     | 82542592/169001437 [00:06<00:12, 6812508.05it/s] 49%|████▉     | 83230720/169001437 [00:06<00:12, 6722230.01it/s] 50%|████▉     | 83918848/169001437 [00:06<00:12, 6745008.88it/s] 50%|█████     | 84639744/169001437 [00:06<00:12, 6776719.46it/s] 51%|█████     | 85393408/169001437 [00:06<00:12, 6850306.32it/s] 51%|█████     | 86179840/169001437 [00:06<00:11, 7135035.98it/s] 51%|█████▏    | 86966272/169001437 [00:07<00:11, 7309346.51it/s] 52%|█████▏    | 87752704/169001437 [00:07<00:10, 7469426.65it/s] 52%|█████▏    | 88604672/169001437 [00:07<00:10, 7732058.36it/s] 53%|█████▎    | 89456640/169001437 [00:07<00:10, 7908746.05it/s] 53%|█████▎    | 90308608/169001437 [00:07<00:09, 8072027.96it/s] 54%|█████▍    | 91226112/169001437 [00:07<00:09, 8329164.01it/s] 55%|█████▍    | 92143616/169001437 [00:07<00:09, 8529074.36it/s] 55%|█████▌    | 93093888/169001437 [00:07<00:08, 8750702.02it/s] 56%|█████▌    | 94076928/169001437 [00:07<00:08, 9020447.98it/s] 56%|█████▋    | 95092736/169001437 [00:07<00:08, 9196363.95it/s] 57%|█████▋    | 96043008/169001437 [00:08<00:08, 9042367.00it/s] 57%|█████▋    | 96960512/169001437 [00:08<00:08, 8442724.20it/s] 58%|█████▊    | 97812480/169001437 [00:08<00:09, 7496512.61it/s] 58%|█████▊    | 98598912/169001437 [00:08<00:10, 6843174.99it/s] 59%|█████▉    | 99319808/169001437 [00:08<00:10, 6560110.86it/s] 59%|█████▉    | 100007936/169001437 [00:08<00:10, 6404991.68it/s] 60%|█████▉    | 100663296/169001437 [00:08<00:10, 6390021.84it/s] 60%|█████▉    | 101318656/169001437 [00:08<00:11, 6059455.89it/s] 60%|██████    | 101941248/169001437 [00:09<00:11, 5696299.99it/s] 61%|██████    | 102531072/169001437 [00:09<00:12, 5501526.00it/s] 61%|██████    | 103088128/169001437 [00:09<00:12, 5429149.80it/s] 61%|██████▏   | 103677952/169001437 [00:09<00:11, 5464198.58it/s] 62%|██████▏   | 104300544/169001437 [00:09<00:11, 5529226.09it/s] 62%|██████▏   | 104857600/169001437 [00:09<00:12, 5210710.79it/s] 62%|██████▏   | 105381888/169001437 [00:09<00:12, 5017654.22it/s] 63%|██████▎   | 105906176/169001437 [00:09<00:12, 4964018.93it/s] 63%|██████▎   | 106430464/169001437 [00:09<00:12, 4958653.19it/s] 63%|██████▎   | 106954752/169001437 [00:10<00:12, 4953290.88it/s] 64%|██████▎   | 107511808/169001437 [00:10<00:12, 5083794.52it/s] 64%|██████▍   | 108036096/169001437 [00:10<00:12, 4953058.76it/s] 64%|██████▍   | 108560384/169001437 [00:10<00:12, 4675140.79it/s] 65%|██████▍   | 109051904/169001437 [00:10<00:13, 4528148.57it/s] 65%|██████▍   | 109543424/169001437 [00:10<00:13, 4545979.81it/s] 65%|██████▌   | 110067712/169001437 [00:10<00:12, 4648725.68it/s] 65%|██████▌   | 110592000/169001437 [00:10<00:12, 4759755.63it/s] 66%|██████▌   | 111181824/169001437 [00:10<00:11, 4949667.16it/s] 66%|██████▌   | 111771648/169001437 [00:11<00:11, 5120684.96it/s] 67%|██████▋   | 112394240/169001437 [00:11<00:10, 5327057.52it/s] 67%|██████▋   | 112951296/169001437 [00:11<00:10, 5221953.52it/s] 67%|██████▋   | 113475584/169001437 [00:11<00:11, 4939285.16it/s] 67%|██████▋   | 113999872/169001437 [00:11<00:11, 4911924.51it/s] 68%|██████▊   | 114524160/169001437 [00:11<00:11, 4908305.02it/s] 68%|██████▊   | 115081216/169001437 [00:11<00:10, 4995952.28it/s] 68%|██████▊   | 115671040/169001437 [00:11<00:10, 4891606.80it/s] 69%|██████▊   | 116162560/169001437 [00:11<00:10, 4810083.13it/s] 69%|██████▉   | 116654080/169001437 [00:12<00:11, 4655723.83it/s] 69%|██████▉   | 117145600/169001437 [00:12<00:11, 4501704.79it/s] 70%|██████▉   | 117669888/169001437 [00:12<00:11, 4603609.10it/s] 70%|██████▉   | 118194176/169001437 [00:12<00:10, 4686126.23it/s] 70%|███████   | 118685696/169001437 [00:12<00:11, 4564418.17it/s] 70%|███████   | 119144448/169001437 [00:12<00:11, 4278399.09it/s] 71%|███████   | 119603200/169001437 [00:12<00:11, 4251788.38it/s] 71%|███████   | 120061952/169001437 [00:12<00:11, 4265998.93it/s] 71%|███████▏  | 120520704/169001437 [00:12<00:11, 4295120.80it/s] 72%|███████▏  | 121012224/169001437 [00:13<00:10, 4434745.39it/s] 72%|███████▏  | 121536512/169001437 [00:13<00:10, 4538057.93it/s] 72%|███████▏  | 122093568/169001437 [00:13<00:09, 4800558.23it/s] 73%|███████▎  | 122683392/169001437 [00:13<00:09, 4994636.95it/s] 73%|███████▎  | 123240448/169001437 [00:13<00:08, 5154111.64it/s] 73%|███████▎  | 123830272/169001437 [00:13<00:08, 5350926.04it/s] 74%|███████▎  | 124485632/169001437 [00:13<00:07, 5591144.52it/s] 74%|███████▍  | 125173760/169001437 [00:13<00:07, 5899082.54it/s] 74%|███████▍  | 125829120/169001437 [00:13<00:07, 6062709.41it/s] 75%|███████▍  | 126451712/169001437 [00:14<00:07, 5991827.97it/s] 75%|███████▌  | 127074304/169001437 [00:14<00:07, 5614277.37it/s] 76%|███████▌  | 127664128/169001437 [00:14<00:07, 5475206.63it/s] 76%|███████▌  | 128221184/169001437 [00:14<00:07, 5411643.70it/s] 76%|███████▌  | 128811008/169001437 [00:14<00:07, 5534373.57it/s] 77%|███████▋  | 129433600/169001437 [00:14<00:06, 5675317.93it/s] 77%|███████▋  | 130056192/169001437 [00:14<00:06, 5778890.98it/s] 77%|███████▋  | 130711552/169001437 [00:14<00:06, 5944545.60it/s] 78%|███████▊  | 131399680/169001437 [00:14<00:06, 6098675.51it/s] 78%|███████▊  | 132120576/169001437 [00:15<00:05, 6284771.89it/s] 79%|███████▊  | 132874240/169001437 [00:15<00:05, 6541757.64it/s] 79%|███████▉  | 133627904/169001437 [00:15<00:05, 6821016.85it/s] 80%|███████▉  | 134414336/169001437 [00:15<00:04, 7027841.55it/s] 80%|███████▉  | 135135232/169001437 [00:15<00:04, 7074014.47it/s] 80%|████████  | 135856128/169001437 [00:15<00:04, 6631677.72it/s] 81%|████████  | 136544256/169001437 [00:15<00:05, 6391837.85it/s] 81%|████████  | 137199616/169001437 [00:15<00:05, 6306202.24it/s] 82%|████████▏ | 137854976/169001437 [00:15<00:05, 6071818.89it/s] 82%|████████▏ | 138477568/169001437 [00:16<00:05, 5616914.24it/s] 82%|████████▏ | 139067392/169001437 [00:16<00:05, 5374703.26it/s] 83%|████████▎ | 139624448/169001437 [00:16<00:05, 5072584.19it/s] 83%|████████▎ | 140148736/169001437 [00:16<00:06, 4611225.58it/s] 83%|████████▎ | 140640256/169001437 [00:16<00:06, 4412679.03it/s] 83%|████████▎ | 141099008/169001437 [00:16<00:06, 4381934.19it/s] 84%|████████▍ | 141590528/169001437 [00:16<00:06, 4425160.72it/s] 84%|████████▍ | 142082048/169001437 [00:16<00:05, 4521251.20it/s] 84%|████████▍ | 142540800/169001437 [00:16<00:06, 4238290.08it/s] 85%|████████▍ | 142999552/169001437 [00:17<00:06, 4060918.24it/s] 85%|████████▍ | 143425536/169001437 [00:17<00:06, 4031899.93it/s] 85%|████████▌ | 143851520/169001437 [00:17<00:06, 4092757.66it/s] 85%|████████▌ | 144310272/169001437 [00:17<00:05, 4187791.24it/s] 86%|████████▌ | 144769024/169001437 [00:17<00:05, 4258493.28it/s] 86%|████████▌ | 145293312/169001437 [00:17<00:05, 4497105.86it/s] 86%|████████▋ | 145817600/169001437 [00:17<00:05, 4624841.59it/s] 87%|████████▋ | 146374656/169001437 [00:17<00:04, 4894302.53it/s] 87%|████████▋ | 146931712/169001437 [00:17<00:04, 5072486.05it/s] 87%|████████▋ | 147521536/169001437 [00:18<00:04, 5277345.28it/s] 88%|████████▊ | 148078592/169001437 [00:18<00:03, 5244307.83it/s] 88%|████████▊ | 148635648/169001437 [00:18<00:04, 4893871.67it/s] 88%|████████▊ | 149159936/169001437 [00:18<00:04, 4834202.80it/s] 89%|████████▊ | 149651456/169001437 [00:18<00:04, 4818651.47it/s] 89%|████████▉ | 150208512/169001437 [00:18<00:03, 4883353.50it/s] 89%|████████▉ | 150765568/169001437 [00:18<00:03, 5022784.80it/s] 90%|████████▉ | 151355392/169001437 [00:18<00:03, 5249966.62it/s] 90%|████████▉ | 151945216/169001437 [00:18<00:03, 5431765.71it/s] 90%|█████████ | 152535040/169001437 [00:19<00:02, 5528499.94it/s] 91%|█████████ | 153190400/169001437 [00:19<00:02, 5794347.14it/s] 91%|█████████ | 153845760/169001437 [00:19<00:02, 6016411.27it/s] 91%|█████████▏| 154501120/169001437 [00:19<00:02, 6128932.11it/s] 92%|█████████▏| 155222016/169001437 [00:19<00:02, 6423391.47it/s] 92%|█████████▏| 155975680/169001437 [00:19<00:01, 6732704.01it/s] 93%|█████████▎| 156696576/169001437 [00:19<00:01, 6807148.81it/s] 93%|█████████▎| 157515776/169001437 [00:19<00:01, 7078711.06it/s] 94%|█████████▎| 158302208/169001437 [00:19<00:01, 7280967.44it/s] 94%|█████████▍| 159088640/169001437 [00:19<00:01, 7433957.18it/s] 95%|█████████▍| 159875072/169001437 [00:20<00:01, 7520780.60it/s] 95%|█████████▌| 160628736/169001437 [00:20<00:01, 7176720.61it/s] 95%|█████████▌| 161349632/169001437 [00:20<00:01, 6406677.23it/s] 96%|█████████▌| 162037760/169001437 [00:20<00:01, 5486038.85it/s] 96%|█████████▌| 162627584/169001437 [00:20<00:01, 4601546.75it/s] 97%|█████████▋| 163151872/169001437 [00:20<00:01, 4268492.23it/s] 97%|█████████▋| 163610624/169001437 [00:20<00:01, 4098164.22it/s] 97%|█████████▋| 164069376/169001437 [00:21<00:01, 4061445.94it/s] 97%|█████████▋| 164495360/169001437 [00:21<00:01, 4095772.75it/s] 98%|█████████▊| 164921344/169001437 [00:21<00:00, 4126135.60it/s] 98%|█████████▊| 165380096/169001437 [00:21<00:00, 4222823.75it/s] 98%|█████████▊| 165904384/169001437 [00:21<00:00, 4385481.28it/s] 98%|█████████▊| 166428672/169001437 [00:21<00:00, 4557931.87it/s] 99%|█████████▉| 166920192/169001437 [00:21<00:00, 4605486.42it/s] 99%|█████████▉| 167411712/169001437 [00:21<00:00, 4354971.62it/s] 99%|█████████▉| 167870464/169001437 [00:21<00:00, 4278136.61it/s]100%|█████████▉| 168329216/169001437 [00:22<00:00, 4255835.32it/s]100%|█████████▉| 168787968/169001437 [00:22<00:00, 4322862.90it/s]100%|██████████| 169001437/169001437 [00:22<00:00, 7628593.61it/s]
/n/home13/asaluja/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/n/home13/asaluja/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /n/home13/asaluja/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s] 16%|█▌        | 7.05M/44.7M [00:00<00:00, 72.3MB/s] 31%|███       | 14.0M/44.7M [00:00<00:00, 46.2MB/s] 42%|████▏     | 18.9M/44.7M [00:00<00:00, 44.5MB/s] 58%|█████▊    | 26.0M/44.7M [00:00<00:00, 53.9MB/s] 70%|███████   | 31.5M/44.7M [00:00<00:00, 46.7MB/s] 85%|████████▍ | 37.9M/44.7M [00:00<00:00, 52.2MB/s]100%|██████████| 44.7M/44.7M [00:00<00:00, 53.5MB/s]
/n/home13/asaluja/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:173: UserWarning: 
NVIDIA H100 80GB HBM3 with CUDA capability sm_90 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70 sm_75 sm_80 sm_86.
If you want to use the NVIDIA H100 80GB HBM3 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(incompatible_device_warn.format(device_name, capability, " ".join(arch_list), device_name))
Traceback (most recent call last):
  File "/n/home13/asaluja/Shrub2/ResNet18+ImageNet/resnet18+imagenet.py", line 264, in <module>
    _ = main_model(images)
  File "/n/home13/asaluja/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/n/home13/asaluja/.local/lib/python3.10/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
  File "/n/home13/asaluja/.local/lib/python3.10/site-packages/torchvision/models/resnet.py", line 269, in _forward_impl
    x = self.bn1(x)
  File "/n/home13/asaluja/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/n/home13/asaluja/.local/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 151, in forward
    self.num_batches_tracked.add_(1)  # type: ignore[has-type]
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

